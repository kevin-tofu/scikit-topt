

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Topology Optimization Algorithm Overview &mdash; scikit-topt 0.1.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
    <link rel="canonical" href="https://kevin-tofu.github.io/scitopt/theory.html" />
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=a58bc63e"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Optimization Algorithms in Density-Based Topology Optimization" href="optimization.html" />
    <link rel="prev" title="Tutorial Page" href="tutorial.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            scikit-topt
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Content</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial Page</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Topology Optimization Algorithm Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#interpolation-setup">Interpolation Setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#initialization">Initialization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#helmholtz-filter">Helmholtz Filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="#heaviside-projection">Heaviside Projection</a></li>
<li class="toctree-l2"><a class="reference internal" href="#compliance-evaluation">Compliance Evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sensitivity-analysis-with-backpropagation">Sensitivity Analysis with Backpropagation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#density-update">Density Update</a></li>
<li class="toctree-l3"><a class="reference internal" href="#stopping-criteria">Stopping Criteria</a></li>
<li class="toctree-l3"><a class="reference internal" href="#next-steps">Next Steps</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="optimization.html">Optimization Algorithms in Density-Based Topology Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">scikit-topt</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Topology Optimization Algorithm Overview</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/theory.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="topology-optimization-algorithm-overview">
<h1>Topology Optimization Algorithm Overview<a class="headerlink" href="#topology-optimization-algorithm-overview" title="Link to this heading"></a></h1>
<p>This page provides a high-level explanation of the topology optimization routine implemented in the <code class="docutils literal notranslate"><span class="pre">optimize</span></code> method. The algorithm follows a density-based approach, using SIMP or RAMP interpolation, a Helmholtz filter, and Heaviside projection to iteratively update the design variables under compliance minimization.</p>
<section id="interpolation-setup">
<h2>Interpolation Setup<a class="headerlink" href="#interpolation-setup" title="Link to this heading"></a></h2>
<p>The optimization supports two types of material interpolation:</p>
<ul class="simple">
<li><p><strong>SIMP</strong>: <span class="math notranslate nohighlight">\(E(\rho) = E_\text{min} + \rho^p (E_0 - E_\text{min})\)</span></p></li>
<li><p><strong>RAMP</strong>: <span class="math notranslate nohighlight">\(E(\rho) = \frac{\rho}{1 + q(1 - \rho)} (E_0 - E_\text{min}) + E_\text{min}\)</span></p></li>
</ul>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\rho\)</span> is the density variable.</p></li>
<li><p><span class="math notranslate nohighlight">\(E_0\)</span> and <span class="math notranslate nohighlight">\(E_\text{min}\)</span> are the maximum and minimum Young’s moduli.</p></li>
<li><p><span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(q\)</span> are penalization parameters.</p></li>
</ul>
<section id="initialization">
<h3>Initialization<a class="headerlink" href="#initialization" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Design variable <span class="math notranslate nohighlight">\(\rho\)</span> is initialized using the <code class="docutils literal notranslate"><span class="pre">vol_frac_init</span></code> or a fixed value depending on the interpolation scheme.</p></li>
<li><p>Restart logic loads a previous design if specified.</p></li>
<li><p>Dirichlet and force boundary elements are set to full material.</p></li>
</ul>
</section>
</section>
<section id="helmholtz-filter">
<h2>Helmholtz Filter<a class="headerlink" href="#helmholtz-filter" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Smooths the density field to ensure minimum length scale.</p></li>
</ul>
<p>In topology optimization, the Helmholtz filter is employed to smooth the density field, ensuring a minimum length scale in the design and mitigating numerical instabilities such as checkerboard patterns.
The filter is defined by the following partial differential equation (PDE):</p>
<div class="math notranslate nohighlight">
\[-r^2 \nabla^2 \tilde{\rho} + \tilde{\rho} = \rho\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\rho\)</span> is the original (unfiltered) density field,</p></li>
<li><p><span class="math notranslate nohighlight">\(\tilde{\rho}\)</span> is the filtered density field,</p></li>
<li><p><span class="math notranslate nohighlight">\(r\)</span> is the filter radius controlling the minimum feature size.</p></li>
</ul>
<p>This PDE is subject to homogeneous Neumann boundary conditions:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial \tilde{\rho}}{\partial n} = 0 \quad \text{on} \quad \partial \Omega\]</div>
<p>where <span class="math notranslate nohighlight">\(\partial \Omega\)</span> denotes the boundary of the design domain.</p>
<p>By solving this equation, the filtered density field <span class="math notranslate nohighlight">\(\tilde{\rho}\)</span> is obtained, which is smoother than the original field <span class="math notranslate nohighlight">\(\rho\)</span>. The filter radius <span class="math notranslate nohighlight">\(r\)</span> determines the extent of smoothing; larger values of <span class="math notranslate nohighlight">\(r\)</span> lead to smoother designs with larger minimum feature sizes.</p>
<p>This approach allows for efficient implementation within finite element frameworks and is particularly advantageous in parallel computing environments, as it requires only local mesh information for the finite element discretization of the problem.</p>
</section>
<section id="heaviside-projection">
<h2>Heaviside Projection<a class="headerlink" href="#heaviside-projection" title="Link to this heading"></a></h2>
<p>In topology optimization, the Heaviside projection is employed to transform intermediate density values into values closer to 0 or 1, promoting a clear distinction between void and solid regions in the design. This approach enhances the manufacturability of the optimized structures by reducing gray areas.</p>
<p>The projection is defined by the following smooth approximation of the Heaviside step function:</p>
<div class="math notranslate nohighlight">
\[\tilde{\rho} = \frac{\tanh(\beta \eta) + \tanh(\beta (\rho - \eta))}{\tanh(\beta \eta) + \tanh(\beta (1 - \eta))}\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\rho\)</span> is the filtered density variable,</p></li>
<li><p><span class="math notranslate nohighlight">\(\tilde{\rho}\)</span> is the projected density,</p></li>
<li><p><span class="math notranslate nohighlight">\(\beta\)</span> is the projection sharpness parameter,</p></li>
<li><p><span class="math notranslate nohighlight">\(\eta\)</span> is the threshold parameter determining the transition point.</p></li>
</ul>
<p>The parameter <span class="math notranslate nohighlight">\(\beta\)</span> controls the steepness of the projection function. A higher value of <span class="math notranslate nohighlight">\(\beta\)</span> results in a steeper transition, effectively pushing the densities towards binary values. Typically, <span class="math notranslate nohighlight">\(\beta\)</span> is gradually increased during the optimization process to allow the design to evolve smoothly before enforcing a more discrete solution.</p>
<p>The threshold parameter <span class="math notranslate nohighlight">\(\eta\)</span> sets the midpoint of the projection. A common choice is <span class="math notranslate nohighlight">\(\eta = 0.5\)</span>, which centers the projection around a density value of 0.5. Adjusting <span class="math notranslate nohighlight">\(\eta\)</span> can shift the transition point, influencing the material distribution in the optimized design.</p>
<p>In the implementation, the threshold parameter <span class="math notranslate nohighlight">\(\eta\)</span> corresponds to the variable <code class="docutils literal notranslate"><span class="pre">beta_eta</span></code>. This variable defines the transition point in the Heaviside projection function, determining the density value at which the projection shifts from favoring void to favoring solid material. There is another eta parameter in the optimization process, which is used with OC method, please do not take it mistakenly.</p>
<p>By applying the Heaviside projection, the optimization process encourages the formation of distinct solid and void regions, leading to designs that are more practical for manufacturing and exhibit improved structural performance.</p>
</section>
<section id="compliance-evaluation">
<h2>Compliance Evaluation<a class="headerlink" href="#compliance-evaluation" title="Link to this heading"></a></h2>
<blockquote>
<div><p>In topology optimization involving multiple load cases, the compliance evaluation process includes the following steps:</p>
</div></blockquote>
<ul>
<li><p><strong>Displacement Field Computation</strong>: For each load case <span class="math notranslate nohighlight">\(i\)</span>, compute the global displacement field <span class="math notranslate nohighlight">\(\mathbf{u}_i\)</span> corresponding to the load vector <span class="math notranslate nohighlight">\(\mathbf{f}_i\)</span>.</p></li>
<li><p><strong>Compliance Calculation</strong>: Evaluate the compliance for each load case as:</p>
<div class="math notranslate nohighlight">
\[C_i = \mathbf{f}_i^T \mathbf{u}_i\]</div>
</li>
<li><p><strong>Total Compliance</strong>: Sum the compliances over all <span class="math notranslate nohighlight">\(N_L\)</span> load cases to obtain the total compliance:</p>
<div class="math notranslate nohighlight">
\[C = \sum_{i=1}^{N_L} \mathbf{f}_i^T \mathbf{u}_i\]</div>
</li>
<li><p><strong>Element-wise strain energy</strong>: it is calculated to derive sensitivity:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial C}{\partial \rho} = -p \rho^{p-1} (E_0 - E_\text{min}) \epsilon^T \mathbf{D} \epsilon\]</div>
</li>
</ul>
</section>
<section id="sensitivity-analysis-with-backpropagation">
<h2>Sensitivity Analysis with Backpropagation<a class="headerlink" href="#sensitivity-analysis-with-backpropagation" title="Link to this heading"></a></h2>
<p>In topology optimization, the sensitivity of the objective function (e.g., compliance) with respect to the design variable <span class="math notranslate nohighlight">\(\rho\)</span> is computed by applying the chain rule through each computational step. This is conceptually similar to backpropagation in machine learning.</p>
<p>Assume the objective function <span class="math notranslate nohighlight">\(C\)</span> depends on the displacement field <span class="math notranslate nohighlight">\(\mathbf{u}\)</span>, which in turn depends on the projected density <span class="math notranslate nohighlight">\(\tilde{\rho}\)</span>, which is computed from the filtered density <span class="math notranslate nohighlight">\(\rho_{\text{filtered}}\)</span>, and ultimately from the design variable <span class="math notranslate nohighlight">\(\rho\)</span>.</p>
<p>The total derivative is written as:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial C}{\partial \rho}
=
\frac{\partial C}{\partial \mathbf{u}}
\cdot
\frac{\partial \mathbf{u}}{\partial \tilde{\rho}}
\cdot
\frac{\partial \tilde{\rho}}{\partial \rho_{\text{filtered}}}
\cdot
\frac{\partial \rho_{\text{filtered}}}{\partial \rho}\]</div>
<p>Each term corresponds to:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\frac{\partial C}{\partial \mathbf{u}}\)</span>: the derivative of compliance with respect to displacement, typically equal to the load vector <span class="math notranslate nohighlight">\(\mathbf{f}\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\frac{\partial \mathbf{u}}{\partial \tilde{\rho}}\)</span>: the derivative of the displacement field with respect to material stiffness, obtained via the adjoint method or differentiating the FEM equilibrium equation.</p></li>
<li><p><span class="math notranslate nohighlight">\(\frac{\partial \tilde{\rho}}{\partial \rho_{\text{filtered}}}\)</span>: the derivative of the Heaviside projection function.</p></li>
<li><p><span class="math notranslate nohighlight">\(\frac{\partial \rho_{\text{filtered}}}{\partial \rho}\)</span>: the derivative of the Helmholtz filter, which is typically linear and defined via the solution of a diffusion-type PDE.</p></li>
</ul>
<p>This chain rule composition allows the gradient of the objective function to be backpropagated from output (compliance) to input (design variable), and is essential for gradient-based optimization algorithms.</p>
<p>As post-processing, the process after the sensitivity Analysis can have is as follows:</p>
<ul class="simple">
<li><p>Gradients are filtered and averaged across load cases.</p></li>
<li><p>Sensitivity filtering is optionally applied post-processing.</p></li>
</ul>
<section id="density-update">
<h3>Density Update<a class="headerlink" href="#density-update" title="Link to this heading"></a></h3>
<p>The densities are updated via a custom update rule using:</p>
<ul class="simple">
<li><p>Move limits</p></li>
<li><p>Target volume fraction</p></li>
<li><p>Sensitivity-based scaling</p></li>
<li><p>Percentile clipping for stability</p></li>
</ul>
</section>
<section id="stopping-criteria">
<h3>Stopping Criteria<a class="headerlink" href="#stopping-criteria" title="Link to this heading"></a></h3>
<p>The process repeats until the maximum number of iterations is reached or convergence criteria are satisfied.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This implementation uses a modular framework where filtering, projection, and updating are decoupled for clarity and extensibility.</p>
</div>
</section>
<section id="next-steps">
<h3>Next Steps<a class="headerlink" href="#next-steps" title="Link to this heading"></a></h3>
<p>Refer to the individual components below for deeper explanation:</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tutorial.html" class="btn btn-neutral float-left" title="Tutorial Page" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="optimization.html" class="btn btn-neutral float-right" title="Optimization Algorithms in Density-Based Topology Optimization" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Kohei Watanabe.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>